
R Under development (unstable) (2012-01-19 r58141)
Copyright (C) 2012 The R Foundation for Statistical Computing
ISBN 3-900051-07-0
Platform: x86_64-unknown-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> library(gmp)

Attaching package: 'gmp'

The following object(s) are masked from 'package:base':

    %*%, apply, crossprod, matrix, tcrossprod

> ## for now -- later we want *.Rout.save file --> not these details
> #sessionInfo()
> #packageDescription("gmp")
> 
> ##
> ##' @title Test a *binary* function
> ##' @param FUN a function, such as add.bigq() ...
> ##' @param out string determining output class; if "str", use characters, otherwise double
> ##' @param x a list of "numbers"
> ##' @return
> ##' @author Antoine Lucas (& Martin Maechler)
> ##' @examples test(as.bigq, 0)
> test <- function(FUN, out = "str", unary = FALSE,
+                  x = list(23,"25", 2.3, -4, as.integer(4), 0, as.bigz(34),
+                  as.bigq(32,7), as.bigz(31,45),NULL,NA,as.integer(-3)))
+ {
+   ##    x<- list(-5,0, as.bigq(1,4),0.5,5,"10",as.integer(100), as.bigz(1000), as.bigz(3,10),NULL,NA)
+   xlabs <- sapply(x, format)
+   stopifnot((n <- length(x)) >= 1)
+   if(out == "str") {
+       sortie <- as.character
+       res <- ""
+       error <- "error"
+   } else {
+       sortie <- as.double
+       res <- 0
+       error <- NA
+   }
+   nr <- if(unary) 1 else n
+   res <- matrix(res, nr, n)
+ 
+   for(i in 1:nr)
+     for(j in 1:n) {
+       e <- if(unary) try(FUN(x[[j]]),        silent = TRUE) else
+                      try(FUN(x[[i]],x[[j]]), silent = TRUE)
+       if(inherits(e, "try-error"))
+         e <- error
+       else if(length(e) == 0)
+         e <- numeric()
+ 
+       res[i,j] <- sortie(e)[1]
+     }
+   res <- as.data.frame(res)
+   ##    dimnames(res)[[1]]<- labels
+   names(res) <- xlabs
+   res
+ }## end{test}
> 
> 
> allfunctionid <- c("as.bigz","add.bigz","sub.bigz","mul.bigz",
+                    "divq.bigz","div.bigz","mod.bigz","pow.bigz",
+                    "inv.bigz","gcd.bigz","lcm.bigz",
+                    "add.bigq","sub.bigq","div.bigq","as.bigq","gcdex",
+ 		   "max.bigq","max.bigz","min.bigq","min.bigz")
> unaryfunctionid <- c("log.bigz","log2.bigz","log10.bigz","c.bigz",
+                      "isprime","nextprime",
+                    "sizeinbase","fibnum","fibnum2","lucnum","lucnum2",
+                      "factorize","abs")
> 
> options(width = 125)
> 
> gmp.NS <- asNamespace("gmp")# also get namespace *hidden* functions, i.e. methods:
> for(fid in allfunctionid)
+   {
+     cat ("------------------------------------------\n", fid, "\n\n", sep="")
+     FUN <- get(fid, envir=gmp.NS, mode="function")
+     print(res <- test(FUN))
+   }
------------------------------------------
as.bigz

           23         25      2.3        -4        4     0         34       32/7 (31 %% 45) NULL   NA        -3
1   (0 %% 23) (23 %% 25) (1 %% 2) (3 %% -4) (3 %% 4) error (23 %% 34) (23 %% 32) (23 %% 31)   23   23 (2 %% -3)
2   (2 %% 23)  (0 %% 25) (1 %% 2) (1 %% -4) (1 %% 4) error (25 %% 34) (25 %% 32) (25 %% 31)   25   25 (1 %% -3)
3   (2 %% 23)  (2 %% 25) (0 %% 2) (2 %% -4) (2 %% 4) error  (2 %% 34)  (2 %% 32)  (2 %% 31)    2    2 (2 %% -3)
4  (19 %% 23) (21 %% 25) (0 %% 2) (0 %% -4) (0 %% 4) error (30 %% 34) (28 %% 32) (27 %% 31)   -4   -4 (2 %% -3)
5   (4 %% 23)  (4 %% 25) (0 %% 2) (0 %% -4) (0 %% 4) error  (4 %% 34)  (4 %% 32)  (4 %% 31)    4    4 (1 %% -3)
6   (0 %% 23)  (0 %% 25) (0 %% 2) (0 %% -4) (0 %% 4) error  (0 %% 34)  (0 %% 32)  (0 %% 31)    0    0 (0 %% -3)
7  (11 %% 23)  (9 %% 25) (0 %% 2) (2 %% -4) (2 %% 4) error  (0 %% 34)  (2 %% 32)  (3 %% 31)   34   34 (1 %% -3)
8   (4 %% 23)  (4 %% 25) (0 %% 2) (0 %% -4) (0 %% 4) error  (4 %% 34)  (4 %% 32)  (4 %% 31)    4    4 (1 %% -3)
9   (8 %% 23)  (6 %% 25) (1 %% 2) (3 %% -4) (3 %% 4) error (31 %% 34) (31 %% 32)  (0 %% 31)   31   31 (1 %% -3)
10       <NA>       <NA>     <NA>      <NA>     <NA>  <NA>       <NA>       <NA>       <NA> <NA> <NA>      <NA>
11         NA         NA       NA        NA       NA error         NA         NA         NA   NA   NA        NA
12 (20 %% 23) (22 %% 25) (1 %% 2) (1 %% -4) (1 %% 4) error (31 %% 34) (29 %% 32) (28 %% 31)   -3   -3 (0 %% -3)
------------------------------------------
add.bigz

          23         25        2.3         -4          4          0         34       32/7 (31 %% 45) NULL   NA         -3
1         46         48         25         19         27         23         57         55  (9 %% 45) <NA>   NA         20
2         48         50         27         21         29         25         59         57 (11 %% 45) <NA>   NA         22
3         25         27          4         -2          6          2         36         34 (33 %% 45) <NA>   NA         -1
4         19         21         -2         -8          0         -4         30         28 (27 %% 45) <NA>   NA         -7
5         27         29          6          0          8          4         38         36 (35 %% 45) <NA>   NA          1
6         23         25          2         -4          4          0         34         32 (31 %% 45) <NA>   NA         -3
7         57         59         36         30         38         34         68         66 (20 %% 45) <NA>   NA         31
8         55         57         34         28         36         32         66         64 (18 %% 45) <NA>   NA         29
9  (9 %% 45) (11 %% 45) (33 %% 45) (27 %% 45) (35 %% 45) (31 %% 45) (20 %% 45) (18 %% 45) (17 %% 45) <NA>   NA (28 %% 45)
10      <NA>       <NA>       <NA>       <NA>       <NA>       <NA>       <NA>       <NA>       <NA> <NA> <NA>       <NA>
11        NA         NA         NA         NA         NA         NA         NA         NA         NA <NA>   NA         NA
12        20         22         -1         -7          1         -3         31         29 (28 %% 45) <NA>   NA         -6
------------------------------------------
sub.bigz

          23        25        2.3         -4          4          0         34       32/7 (31 %% 45)       NULL   NA
1          0        -2         21         27         19         23        -11         -9 (37 %% 45)        -23   NA
2          2         0         23         29         21         25         -9         -7 (39 %% 45)        -25   NA
3        -21       -23          0          6         -2          2        -32        -30 (16 %% 45)         -2   NA
4        -27       -29         -6          0         -8         -4        -38        -36 (10 %% 45)          4   NA
5        -19       -21          2          8          0          4        -30        -28 (18 %% 45)         -4   NA
6        -23       -25         -2          4         -4          0        -34        -32 (14 %% 45)          0   NA
7         11         9         32         38         30         34          0          2  (3 %% 45)        -34   NA
8          9         7         30         36         28         32         -2          0  (1 %% 45)        -32   NA
9  (8 %% 45) (6 %% 45) (29 %% 45) (35 %% 45) (27 %% 45) (31 %% 45) (42 %% 45) (44 %% 45)  (0 %% 45) (14 %% 45)   NA
10      <NA>      <NA>       <NA>       <NA>       <NA>       <NA>       <NA>       <NA>       <NA>       <NA> <NA>
11        NA        NA         NA         NA         NA         NA         NA         NA         NA         NA   NA
12       -26       -28         -5          1         -7         -3        -37        -35 (11 %% 45)          3   NA
           -3
1          26
2          28
3           5
4          -1
5           7
6           3
7          37
8          35
9  (34 %% 45)
10       <NA>
11         NA
12          0
------------------------------------------
mul.bigz

           23         25        2.3         -4          4         0         34      32/7 (31 %% 45) NULL   NA         -3
1         529        575         46        -92         92         0        782       736 (38 %% 45) <NA>   NA        -69
2         575        625         50       -100        100         0        850       800 (10 %% 45) <NA>   NA        -75
3          46         50          4         -8          8         0         68        64 (17 %% 45) <NA>   NA         -6
4         -92       -100         -8         16        -16         0       -136      -128 (11 %% 45) <NA>   NA         12
5          92        100          8        -16         16         0        136       128 (34 %% 45) <NA>   NA        -12
6           0          0          0          0          0         0          0         0  (0 %% 45) <NA>   NA          0
7         782        850         68       -136        136         0       1156      1088 (19 %% 45) <NA>   NA       -102
8         736        800         64       -128        128         0       1088      1024  (2 %% 45) <NA>   NA        -96
9  (38 %% 45) (10 %% 45) (17 %% 45) (11 %% 45) (34 %% 45) (0 %% 45) (19 %% 45) (2 %% 45) (16 %% 45) <NA>   NA (42 %% 45)
10       <NA>       <NA>       <NA>       <NA>       <NA>      <NA>       <NA>      <NA>       <NA> <NA> <NA>       <NA>
11         NA         NA         NA         NA         NA        NA         NA        NA         NA <NA>   NA         NA
12        -69        -75         -6         12        -12         0       -102       -96 (42 %% 45) <NA>   NA          9
------------------------------------------
divq.bigz

          23        25        2.3         -4         4     0        34      32/7 (31 %% 45) NULL   NA         -3
1          1         0         11         -5         5 error         0         0  (0 %% 45) <NA>   NA         -7
2          1         1         12         -6         6 error         0         0  (0 %% 45) <NA>   NA         -8
3          0         0          1          0         0 error         0         0  (0 %% 45) <NA>   NA          0
4          0         0         -2          1        -1 error         0         0  (0 %% 45) <NA>   NA          1
5          0         0          2         -1         1 error         0         0  (0 %% 45) <NA>   NA         -1
6          0         0          0          0         0 error         0         0  (0 %% 45) <NA>   NA          0
7          1         1         17         -8         8 error         1         1  (1 %% 45) <NA>   NA        -11
8          1         1         16         -8         8 error         0         1  (1 %% 45) <NA>   NA        -10
9  (1 %% 45) (1 %% 45) (15 %% 45) (38 %% 45) (7 %% 45) error (0 %% 45) (0 %% 45)  (1 %% 45) <NA>   NA (35 %% 45)
10      <NA>      <NA>       <NA>       <NA>      <NA>  <NA>      <NA>      <NA>       <NA> <NA> <NA>       <NA>
11        NA        NA         NA         NA        NA    NA        NA        NA         NA <NA>   NA         NA
12         0         0         -1          0         0 error         0         0  (0 %% 45) <NA>   NA          1
------------------------------------------
div.bigz

                                   23                               25                                 2.3
1                                   1                            23/25  25895697857380352/2589569785738035
2                               25/23                                1    5629499534213120/517913957147607
3  2589569785738035/25895697857380352 517913957147607/5629499534213120                                   1
4                               -4/23                            -4/25  -4503599627370496/2589569785738035
5                                4/23                             4/25   4503599627370496/2589569785738035
6                                   0                                0                                   0
7                               34/23                            34/25  38280596832649216/2589569785738035
8                              32/161                           32/175 36028797018963968/18126988500166245
9                           (1 %% 45)                        (1 %% 45)                          (15 %% 45)
10                               <NA>                             <NA>                                <NA>
11                                 NA                               NA                                  NA
12                              -3/23                            -3/25   -1125899906842624/863189928579345
                                   -4                                 4     0                                 34
1                               -23/4                              23/4 error                              23/34
2                               -25/4                              25/4 error                              25/34
3  -2589569785738035/4503599627370496 2589569785738035/4503599627370496 error 2589569785738035/38280596832649216
4                                   1                                -1 error                              -2/17
5                                  -1                                 1 error                               2/17
6                                   0                                 0 error                                  0
7                               -17/2                              17/2 error                                  1
8                                -8/7                               8/7 error                             16/119
9                          (38 %% 45)                         (7 %% 45) error                          (0 %% 45)
10                               <NA>                              <NA>  <NA>                               <NA>
11                                 NA                                NA    NA                                 NA
12                                3/4                              -3/4 error                              -3/34
                                  32/7 (31 %% 45) NULL   NA                                -3
1                               161/32  (0 %% 45) <NA>   NA                             -23/3
2                               175/32  (0 %% 45) <NA>   NA                             -25/3
3  18126988500166245/36028797018963968  (0 %% 45) <NA>   NA -863189928579345/1125899906842624
4                                 -7/8  (0 %% 45) <NA>   NA                               4/3
5                                  7/8  (0 %% 45) <NA>   NA                              -4/3
6                                    0  (0 %% 45) <NA>   NA                                 0
7                               119/16  (1 %% 45) <NA>   NA                             -34/3
8                                    1  (1 %% 45) <NA>   NA                            -32/21
9                            (0 %% 45)  (1 %% 45) <NA>   NA                        (35 %% 45)
10                                <NA>       <NA> <NA> <NA>                              <NA>
11                                  NA         NA <NA>   NA                                NA
12                              -21/32  (0 %% 45) <NA>   NA                                 1
------------------------------------------
mod.bigz

          23        25      2.3        -4        4     0         34       32/7 (31 %% 45) NULL   NA        -3
1          0        23        1         3        3 error         23         23 (23 %% 31) <NA>   NA         2
2          2         0        1         1        1 error         25         25 (25 %% 31) <NA>   NA         1
3          2         2        0         2        2 error          2          2  (2 %% 31) <NA>   NA         2
4         19        21        0         0        0 error         30         28 (27 %% 31) <NA>   NA         2
5          4         4        0         0        0 error          4          4  (4 %% 31) <NA>   NA         1
6          0         0        0         0        0 error          0          0  (0 %% 31) <NA>   NA         0
7         11         9        0         2        2 error          0          2  (3 %% 31) <NA>   NA         1
8          9         7        0         0        0 error         32          0  (1 %% 31) <NA>   NA         2
9  (8 %% 23) (6 %% 25) (1 %% 2) (3 %% -4) (3 %% 4) error (31 %% 34) (31 %% 32)  (0 %% 31) <NA>   NA (1 %% -3)
10      <NA>      <NA>     <NA>      <NA>     <NA>  <NA>       <NA>       <NA>       <NA> <NA> <NA>      <NA>
11        NA        NA       NA        NA       NA    NA         NA         NA         NA <NA>   NA        NA
12        20        22        1         1        1 error         31         29 (28 %% 31) <NA>   NA         0
------------------------------------------
pow.bigz

                                     23                                      25        2.3         -4          4         0
1      20880467999847912034355032910567     11045767571919545466173812409689943        529      error     279841         1
2     142108547152020037174224853515625     88817841970012523233890533447265625        625      error     390625         1
3                               8388608                                33554432          4      error         16         1
4                       -70368744177664                       -1125899906842624         16      error        256         1
5                        70368744177664                        1125899906842624         16      error        256         1
6                                     0                                       0          0      error          0         1
7  167500108222301408246337399112597504 193630125104980427932766033374162714624       1156      error    1336336         1
8   41538374868278621028243970633760768  42535295865117307932921825928971026432       1024      error    1048576         1
9                            (16 %% 45)                              (31 %% 45) (16 %% 45) (16 %% 45) (31 %% 45) (1 %% 45)
10                                 <NA>                                    <NA>       <NA>       <NA>       <NA>      <NA>
11                                   NA                                      NA         NA         NA         NA        NA
12                         -94143178827                           -847288609443          9      error         81         1
                                                      34                                               32/7 (31 %% 45) NULL
1        19895113660064588580108197261066338165074766609       37608910510519071039902074217516707306379521 (32 %% 45) <NA>
2       338813178901720135627329000271856784820556640625      542101086242752217003726400434970855712890625 (25 %% 45) <NA>
3                                            17179869184                                         4294967296 (38 %% 45) <NA>
4                                  295147905179352825856                               18446744073709551616 (41 %% 45) <NA>
5                                  295147905179352825856                               18446744073709551616  (4 %% 45) <NA>
6                                                      0                                                  0  (0 %% 45) <NA>
7  11756638905368616011414050501310355554617941909569536 10170102859315411774579628461341138023025901305856 (34 %% 45) <NA>
8   1496577676626844588240573268701473812127674924007424  1461501637330902918203684832716283019655932542976 (23 %% 45) <NA>
9                                             (31 %% 45)                                         (16 %% 45) (31 %% 45) <NA>
10                                                  <NA>                                               <NA>       <NA> <NA>
11                                                    NA                                                 NA         NA <NA>
12                                     16677181699666569                                   1853020188851841 (18 %% 45) <NA>
     NA        -3
1    NA     error
2    NA     error
3    NA     error
4    NA     error
5    NA     error
6    NA     error
7    NA     error
8    NA     error
9    NA (1 %% 45)
10 <NA>      <NA>
11   NA        NA
12   NA     error
------------------------------------------
inv.bigz

          23         25       2.3        -4         4     0         34       32/7 (31 %% 45) NULL   NA        -3
1      error         12         1         3         3 error          3          7 (27 %% 45) <NA>   NA         2
2         12      error         1         1         1 error         15          9  (5 %% 45) <NA>   NA         1
3         12         13     error     error     error error      error      error (16 %% 45) <NA>   NA         2
4         17          6     error     error     error error      error      error (23 %% 45) <NA>   NA         2
5          6         19     error     error     error error      error      error  (8 %% 45) <NA>   NA         1
6      error      error     error     error     error error      error      error      error <NA>   NA     error
7         21         14     error     error     error error      error      error (21 %% 45) <NA>   NA         1
8         18         18     error     error     error error      error      error  (1 %% 45) <NA>   NA         2
9  (3 %% 45) (21 %% 45) (1 %% 45) (3 %% 45) (3 %% 45) error (11 %% 45) (31 %% 45)      error <NA>   NA (1 %% 45)
10      <NA>       <NA>      <NA>      <NA>      <NA>  <NA>       <NA>       <NA>       <NA> <NA> <NA>      <NA>
11        NA         NA        NA        NA        NA    NA         NA         NA         NA <NA>   NA        NA
12        15          8         1         1         1 error         11         21 (10 %% 45) <NA>   NA     error
------------------------------------------
gcd.bigz

          23        25       2.3        -4         4          0        34      32/7 (31 %% 45) NULL   NA        -3
1         23         1         1         1         1         23         1         1  (1 %% 45) <NA>   NA         1
2          1        25         1         1         1         25         1         1  (1 %% 45) <NA>   NA         1
3          1         1         2         2         2          2         2         2  (1 %% 45) <NA>   NA         1
4          1         1         2         4         4          4         2         4  (1 %% 45) <NA>   NA         1
5          1         1         2         4         4          4         2         4  (1 %% 45) <NA>   NA         1
6         23        25         2         4         4          0        34        32 (31 %% 45) <NA>   NA         3
7          1         1         2         2         2         34        34         2  (1 %% 45) <NA>   NA         1
8          1         1         2         4         4         32         2        32  (1 %% 45) <NA>   NA         1
9  (1 %% 45) (1 %% 45) (1 %% 45) (1 %% 45) (1 %% 45) (31 %% 45) (1 %% 45) (1 %% 45) (31 %% 45) <NA>   NA (1 %% 45)
10      <NA>      <NA>      <NA>      <NA>      <NA>       <NA>      <NA>      <NA>       <NA> <NA> <NA>      <NA>
11        NA        NA        NA        NA        NA         NA        NA        NA         NA <NA>   NA        NA
12         1         1         1         1         1          3         1         1  (1 %% 45) <NA>   NA         3
------------------------------------------
lcm.bigz

           23         25        2.3         -4          4         0         34      32/7 (31 %% 45) NULL   NA        -3
1          23        575         46         92         92         0        782       736 (38 %% 45) <NA>   NA        69
2         575         25         50        100        100         0        850       800 (10 %% 45) <NA>   NA        75
3          46         50          2          4          4         0         34        32 (17 %% 45) <NA>   NA         6
4          92        100          4          4          4         0         68        32 (34 %% 45) <NA>   NA        12
5          92        100          4          4          4         0         68        32 (34 %% 45) <NA>   NA        12
6           0          0          0          0          0         0          0         0  (0 %% 45) <NA>   NA         0
7         782        850         34         68         68         0         34       544 (19 %% 45) <NA>   NA       102
8         736        800         32         32         32         0        544        32  (2 %% 45) <NA>   NA        96
9  (38 %% 45) (10 %% 45) (17 %% 45) (34 %% 45) (34 %% 45) (0 %% 45) (19 %% 45) (2 %% 45) (31 %% 45) <NA>   NA (3 %% 45)
10       <NA>       <NA>       <NA>       <NA>       <NA>      <NA>       <NA>      <NA>       <NA> <NA> <NA>      <NA>
11         NA         NA         NA         NA         NA        NA         NA        NA         NA <NA>   NA        NA
12         69         75          6         12         12         0        102        96  (3 %% 45) <NA>   NA         3
------------------------------------------
add.bigq

                                   23                                 25                                2.3
1                                  46                                 48 28485267643118387/1125899906842624
2                                  48                                 50 30737067456803635/1125899906842624
3  28485267643118387/1125899906842624 30737067456803635/1125899906842624   2589569785738035/562949953421312
4                                  19                                 21 -1914029841632461/1125899906842624
5                                  27                                 29  7093169413108531/1125899906842624
6                                  23                                 25  2589569785738035/1125899906842624
7                                  57                                 59 40870166618387251/1125899906842624
8                               193/7                              207/7 54155785519130213/7881299347898368
9                                  54                                 56 37492466897859379/1125899906842624
10                               <NA>                               <NA>                               <NA>
11                                 NA                                 NA                                 NA
12                                 20                                 22  -788129934789837/1125899906842624
                                   -4                                 4                                 0
1                                  19                                27                                23
2                                  21                                29                                25
3  -1914029841632461/1125899906842624 7093169413108531/1125899906842624 2589569785738035/1125899906842624
4                                  -8                                 0                                -4
5                                   0                                 8                                 4
6                                  -4                                 4                                 0
7                                  30                                38                                34
8                                 4/7                              60/7                              32/7
9                                  27                                35                                31
10                               <NA>                              <NA>                              <NA>
11                                 NA                                NA                                NA
12                                 -7                                 1                                -3
                                   34                               32/7                         (31 %% 45) NULL   NA
1                                  57                              193/7                                 54 <NA>   NA
2                                  59                              207/7                                 56 <NA>   NA
3  40870166618387251/1125899906842624 54155785519130213/7881299347898368 37492466897859379/1125899906842624 <NA>   NA
4                                  30                                4/7                                 27 <NA>   NA
5                                  38                               60/7                                 35 <NA>   NA
6                                  34                               32/7                                 31 <NA>   NA
7                                  68                              270/7                                 65 <NA>   NA
8                               270/7                               64/7                              249/7 <NA>   NA
9                                  65                              249/7                                 62 <NA>   NA
10                               <NA>                               <NA>                               <NA> <NA> <NA>
11                                 NA                                 NA                                 NA <NA>   NA
12                                 31                               11/7                                 28 <NA>   NA
                                  -3
1                                 20
2                                 22
3  -788129934789837/1125899906842624
4                                 -7
5                                  1
6                                 -3
7                                 31
8                               11/7
9                                 28
10                              <NA>
11                                NA
12                                -6
------------------------------------------
sub.bigq

                                    23                                  25                                2.3
1                                    0                                  -2 23306128071642317/1125899906842624
2                                    2                                   0 25557927885327565/1125899906842624
3  -23306128071642317/1125899906842624 -25557927885327565/1125899906842624                                  0
4                                  -27                                 -29 -7093169413108531/1125899906842624
5                                  -19                                 -21  1914029841632461/1125899906842624
6                                  -23                                 -25 -2589569785738035/1125899906842624
7                                   11                                   9 35691027046911181/1125899906842624
8                               -129/7                              -143/7 17901808518797723/7881299347898368
9                                    8                                   6 32313327326383309/1125899906842624
10                                <NA>                                <NA>                               <NA>
11                                  NA                                  NA                                 NA
12                                 -26                                 -28 -5967269506265907/1125899906842624
                                  -4                                  4                                 0
1                                 27                                 19                                23
2                                 29                                 21                                25
3  7093169413108531/1125899906842624 -1914029841632461/1125899906842624 2589569785738035/1125899906842624
4                                  0                                 -8                                -4
5                                  8                                  0                                 4
6                                  4                                 -4                                 0
7                                 38                                 30                                34
8                               60/7                                4/7                              32/7
9                                 35                                 27                                31
10                              <NA>                               <NA>                              <NA>
11                                NA                                 NA                                NA
12                                 1                                 -7                                -3
                                    34                                32/7                          (31 %% 45)
1                                  -11                               129/7                                  -8
2                                   -9                               143/7                                  -6
3  -35691027046911181/1125899906842624 -17901808518797723/7881299347898368 -32313327326383309/1125899906842624
4                                  -38                               -60/7                                 -35
5                                  -30                                -4/7                                 -27
6                                  -34                               -32/7                                 -31
7                                    0                               206/7                                   3
8                               -206/7                                   0                              -185/7
9                                   -3                               185/7                                   0
10                                <NA>                                <NA>                                <NA>
11                                  NA                                  NA                                  NA
12                                 -37                               -53/7                                 -34
                                 NULL   NA                                -3
1                                 -23   NA                                26
2                                 -25   NA                                28
3  -2589569785738035/1125899906842624   NA 5967269506265907/1125899906842624
4                                   4   NA                                -1
5                                  -4   NA                                 7
6                                   0   NA                                 3
7                                 -34   NA                                37
8                               -32/7   NA                              53/7
9                                 -31   NA                                34
10                               <NA> <NA>                              <NA>
11                                 NA   NA                                NA
12                                  3   NA                                 0
------------------------------------------
div.bigq

                                   23                               25                                 2.3
1                                   1                            23/25  25895697857380352/2589569785738035
2                               25/23                                1    5629499534213120/517913957147607
3  2589569785738035/25895697857380352 517913957147607/5629499534213120                                   1
4                               -4/23                            -4/25  -4503599627370496/2589569785738035
5                                4/23                             4/25   4503599627370496/2589569785738035
6                                   0                                0                                   0
7                               34/23                            34/25  38280596832649216/2589569785738035
8                              32/161                           32/175 36028797018963968/18126988500166245
9                               31/23                            31/25  34902897112121344/2589569785738035
10                               <NA>                             <NA>                                <NA>
11                                 NA                               NA                                  NA
12                              -3/23                            -3/25   -1125899906842624/863189928579345
                                   -4                                 4     0                                 34
1                               -23/4                              23/4 error                              23/34
2                               -25/4                              25/4 error                              25/34
3  -2589569785738035/4503599627370496 2589569785738035/4503599627370496 error 2589569785738035/38280596832649216
4                                   1                                -1 error                              -2/17
5                                  -1                                 1 error                               2/17
6                                   0                                 0 error                                  0
7                               -17/2                              17/2 error                                  1
8                                -8/7                               8/7 error                             16/119
9                               -31/4                              31/4 error                              31/34
10                               <NA>                              <NA>  <NA>                               <NA>
11                                 NA                                NA    NA                                 NA
12                                3/4                              -3/4 error                              -3/34
                                  32/7                         (31 %% 45) NULL   NA                                -3
1                               161/32                              23/31 <NA>   NA                             -23/3
2                               175/32                              25/31 <NA>   NA                             -25/3
3  18126988500166245/36028797018963968 2589569785738035/34902897112121344 <NA>   NA -863189928579345/1125899906842624
4                                 -7/8                              -4/31 <NA>   NA                               4/3
5                                  7/8                               4/31 <NA>   NA                              -4/3
6                                    0                                  0 <NA>   NA                                 0
7                               119/16                              34/31 <NA>   NA                             -34/3
8                                    1                             32/217 <NA>   NA                            -32/21
9                               217/32                                  1 <NA>   NA                             -31/3
10                                <NA>                               <NA> <NA> <NA>                              <NA>
11                                  NA                                 NA <NA>   NA                                NA
12                              -21/32                              -3/31 <NA>   NA                                 1
------------------------------------------
as.bigq

                                   23                               25                                 2.3
1                                   1                            23/25  25895697857380352/2589569785738035
2                               25/23                                1    5629499534213120/517913957147607
3  2589569785738035/25895697857380352 517913957147607/5629499534213120                                   1
4                               -4/23                            -4/25  -4503599627370496/2589569785738035
5                                4/23                             4/25   4503599627370496/2589569785738035
6                                   0                                0                                   0
7                               34/23                            34/25  38280596832649216/2589569785738035
8                              32/161                           32/175 36028797018963968/18126988500166245
9                               31/23                            31/25  34902897112121344/2589569785738035
10                               <NA>                             <NA>                                <NA>
11                                 NA                               NA                                  NA
12                              -3/23                            -3/25   -1125899906842624/863189928579345
                                   -4                                 4     0                                 34
1                               -23/4                              23/4 error                              23/34
2                               -25/4                              25/4 error                              25/34
3  -2589569785738035/4503599627370496 2589569785738035/4503599627370496 error 2589569785738035/38280596832649216
4                                   1                                -1 error                              -2/17
5                                  -1                                 1 error                               2/17
6                                   0                                 0 error                                  0
7                               -17/2                              17/2 error                                  1
8                                -8/7                               8/7 error                             16/119
9                               -31/4                              31/4 error                              31/34
10                               <NA>                              <NA>  <NA>                               <NA>
11                                 NA                                NA    NA                                 NA
12                                3/4                              -3/4 error                              -3/34
                                  32/7                         (31 %% 45) NULL   NA                                -3
1                               161/32                              23/31 <NA>   NA                             -23/3
2                               175/32                              25/31 <NA>   NA                             -25/3
3  18126988500166245/36028797018963968 2589569785738035/34902897112121344 <NA>   NA -863189928579345/1125899906842624
4                                 -7/8                              -4/31 <NA>   NA                               4/3
5                                  7/8                               4/31 <NA>   NA                              -4/3
6                                    0                                  0 <NA>   NA                                 0
7                               119/16                              34/31 <NA>   NA                             -34/3
8                                    1                             32/217 <NA>   NA                            -32/21
9                               217/32                                  1 <NA>   NA                             -31/3
10                                <NA>                               <NA> <NA> <NA>                              <NA>
11                                  NA                                 NA <NA>   NA                                NA
12                              -21/32                              -3/31 <NA>   NA                                 1
------------------------------------------
gcdex

     23   25  2.3   -4    4    0   34 32/7 (31 %% 45) NULL   NA   -3
1    23    1    1    1    1   23    1    1          1 <NA>   23    1
2     1   25    1    1    1   25    1    1          1 <NA>   25    1
3     1    1    2    2    2    2    2    2          1 <NA>    2    1
4     1    1    2    4    4    4    2    4          1 <NA>    4    1
5     1    1    2    4    4    4    2    4          1 <NA>    4    1
6    23   25    2    4    4    0   34   32         31 <NA>    0    3
7     1    1    2    2    2   34   34    2          1 <NA>   34    1
8     1    1    2    4    4   32    2   32          1 <NA>   32    1
9     1    1    1    1    1   31    1    1         31 <NA>   31    1
10 <NA> <NA> <NA> <NA> <NA> <NA> <NA> <NA>       <NA> <NA> <NA> <NA>
11   23   25    2    4    4    0   34   32         31 <NA>    0    3
12    1    1    1    1    1    3    1    1          1 <NA>    3    3
------------------------------------------
max.bigq

   23 25                               2.3                                -4    4                                 0 34 32/7
1  23 25                                23                                23   23                                23 34   23
2  25 25                                25                                25   25                                25 34   25
3  23 25 2589569785738035/1125899906842624 2589569785738035/1125899906842624    4 2589569785738035/1125899906842624 34 32/7
4  23 25 2589569785738035/1125899906842624                                -4    4                                 0 34 32/7
5  23 25                                 4                                 4    4                                 4 34 32/7
6  23 25 2589569785738035/1125899906842624                                 0    4                                 0 34 32/7
7  34 34                                34                                34   34                                34 34   34
8  23 25                              32/7                              32/7 32/7                              32/7 34 32/7
9  31 31                                31                                31   31                                31 34   31
10 23 25 2589569785738035/1125899906842624                                -4    4                                 0 34 32/7
11 23 25 2589569785738035/1125899906842624                                -4    4                                 0 34 32/7
12 23 25 2589569785738035/1125899906842624                                -3    4                                 0 34 32/7
   (31 %% 45)                              NULL   NA                                -3
1          31                                23 <NA>                                23
2          31                                25 <NA>                                25
3          31 2589569785738035/1125899906842624 <NA> 2589569785738035/1125899906842624
4          31                                -4 <NA>                                -3
5          31                                 4 <NA>                                 4
6          31                                 0 <NA>                                 0
7          34                                34 <NA>                                34
8          31                              32/7 <NA>                              32/7
9          31                                31 <NA>                                31
10         31                              <NA>   NA                                -3
11         31                                NA <NA>                                -3
12         31                                -3 <NA>                                -3
------------------------------------------
max.bigz

           23         25        2.3         -4          4          0         34       32/7 (31 %% 45)       NULL   NA
1          23         25         23         23         23         23         34         32         31         23 <NA>
2          25         25         25         25         25         25         34         32         31         25 <NA>
3          23         25          2          2          4          2         34         32         31          2 <NA>
4          23         25          2         -4          4          0         34         32         31         -4 <NA>
5          23         25          4          4          4          4         34         32         31          4 <NA>
6          23         25          2          0          4          0         34         32         31          0 <NA>
7          34         34         34         34         34         34         34         34         34         34 <NA>
8          32         32         32         32         32         32         34         32         32         32 <NA>
9  (31 %% 45) (31 %% 45) (31 %% 45) (31 %% 45) (31 %% 45) (31 %% 45) (34 %% 45) (32 %% 45) (31 %% 45) (31 %% 45) <NA>
10         23         25          2         -4          4          0         34         32 (31 %% 45)       <NA>   NA
11         23         25          2         -4          4          0         34         32         31         NA <NA>
12         23         25          2         -3          4          0         34         32         31         -3 <NA>
           -3
1          23
2          25
3           2
4          -3
5           4
6           0
7          34
8          32
9  (31 %% 45)
10         -3
11         -3
12         -3
------------------------------------------
min.bigq

                                  23                                25                               2.3 -4
1                                 23                                23 2589569785738035/1125899906842624 -4
2                                 23                                25 2589569785738035/1125899906842624 -4
3  2589569785738035/1125899906842624 2589569785738035/1125899906842624 2589569785738035/1125899906842624 -4
4                                 -4                                -4                                -4 -4
5                                  4                                 4 2589569785738035/1125899906842624 -4
6                                  0                                 0                                 0 -4
7                                 23                                25 2589569785738035/1125899906842624 -4
8                               32/7                              32/7 2589569785738035/1125899906842624 -4
9                                 23                                25 2589569785738035/1125899906842624 -4
10                                23                                25 2589569785738035/1125899906842624 -4
11                                23                                25 2589569785738035/1125899906842624 -4
12                                -3                                -3                                -3 -4
                                   4  0                                34                              32/7
1                                  4  0                                23                              32/7
2                                  4  0                                25                              32/7
3  2589569785738035/1125899906842624  0 2589569785738035/1125899906842624 2589569785738035/1125899906842624
4                                 -4 -4                                -4                                -4
5                                  4  0                                 4                                 4
6                                  0  0                                 0                                 0
7                                  4  0                                34                              32/7
8                                  4  0                              32/7                              32/7
9                                  4  0                                31                              32/7
10                                 4  0                                34                              32/7
11                                 4  0                                34                              32/7
12                                -3 -3                                -3                                -3
                          (31 %% 45)                              NULL   NA -3
1                                 23                                23 <NA> -3
2                                 25                                25 <NA> -3
3  2589569785738035/1125899906842624 2589569785738035/1125899906842624 <NA> -3
4                                 -4                                -4 <NA> -4
5                                  4                                 4 <NA> -3
6                                  0                                 0 <NA> -3
7                                 31                                34 <NA> -3
8                               32/7                              32/7 <NA> -3
9                                 31                                31 <NA> -3
10                                31                              <NA>   NA -3
11                                31                                NA <NA> -3
12                                -3                                -3 <NA> -3
------------------------------------------
min.bigz

           23         25       2.3         -4         4         0         34       32/7 (31 %% 45)       NULL   NA
1          23         23         2         -4         4         0         23         23         23         23 <NA>
2          23         25         2         -4         4         0         25         25         25         25 <NA>
3           2          2         2         -4         2         0          2          2          2          2 <NA>
4          -4         -4        -4         -4        -4        -4         -4         -4         -4         -4 <NA>
5           4          4         2         -4         4         0          4          4          4          4 <NA>
6           0          0         0         -4         0         0          0          0          0          0 <NA>
7          23         25         2         -4         4         0         34         32         31         34 <NA>
8          23         25         2         -4         4         0         32         32         31         32 <NA>
9  (23 %% 45) (25 %% 45) (2 %% 45) (-4 %% 45) (4 %% 45) (0 %% 45) (31 %% 45) (31 %% 45) (31 %% 45) (31 %% 45) <NA>
10         23         25         2         -4         4         0         34         32 (31 %% 45)       <NA>   NA
11         23         25         2         -4         4         0         34         32         31         NA <NA>
12         -3         -3        -3         -4        -3        -3         -3         -3         -3         -3 <NA>
           -3
1          -3
2          -3
3          -3
4          -4
5          -3
6          -3
7          -3
8          -3
9  (-3 %% 45)
10         -3
11         -3
12         -3
> 
> ##==============================================================================
> 
> for(fid in unaryfunctionid)
+   {
+     cat ("------------------------------------------\n", fid, "\n\n", sep="")
+     FUN <- get(fid, envir = gmp.NS, mode="function")
+     print(res <- test(FUN, unary=TRUE))
+   }
------------------------------------------
log.bigz

                23              25               2.3  -4                4    0               34             32/7
1 3.13549421592915 3.2188758248682 0.693147180559945 NaN 1.38629436111989 -Inf 3.52636052461616 3.46573590279973
        (31 %% 45) NULL   NA  -3
1 3.43398720448515 <NA> -Inf NaN
------------------------------------------
log2.bigz

                23               25 2.3  -4 4    0               34 32/7       (31 %% 45) NULL   NA  -3
1 4.52356195605701 4.64385618977472   1 NaN 2 -Inf 5.08746284125034    5 4.95419631038687 <NA> -Inf NaN
------------------------------------------
log10.bigz

                23               25               2.3  -4                 4    0               34             32/7
1 1.36172783601759 1.39794000867204 0.301029995663981 NaN 0.602059991327962 -Inf 1.53147891704225 1.50514997831991
        (31 %% 45) NULL   NA  -3
1 1.49136169383427 <NA> -Inf NaN
------------------------------------------
c.bigz

  23 25 2.3 -4 4 0 34 32/7 (31 %% 45) NULL NA -3
1 23 25   2 -4 4 0 34   32 (31 %% 45) <NA> NA -3
------------------------------------------
isprime

  23 25 2.3 -4 4 0 34 32/7 (31 %% 45) NULL NA -3
1  2  0   2  0 0 0  0    0          2 <NA>  0  2
------------------------------------------
nextprime

  23 25 2.3 -4 4 0 34 32/7 (31 %% 45) NULL NA -3
1 29 29   3  2 5 2 37   37         37 <NA>  2  2
------------------------------------------
sizeinbase

  23 25 2.3 -4 4 0 34 32/7 (31 %% 45) NULL NA -3
1  2  2   1  1 1 1  2    2          2 <NA>  1  1
------------------------------------------
fibnum

     23    25 2.3    -4 4 0 34 32/7 (31 %% 45) NULL    NA    -3
1 28657 75025   1 error 3 0  1    1          1 <NA> error error
------------------------------------------
fibnum2

     23    25 2.3    -4 4 0 34 32/7 (31 %% 45)  NULL    NA    -3
1 17711 46368   1 error 2 1  0    0          0 error error error
------------------------------------------
lucnum

     23     25 2.3    -4 4 0 34 32/7 (31 %% 45) NULL    NA    -3
1 64079 167761   3 error 7 2  1    1          1 <NA> error error
------------------------------------------
lucnum2

     23     25 2.3    -4 4  0 34 32/7 (31 %% 45)  NULL    NA    -3
1 39603 103682   1 error 4 -1  2    2          2 error error error
------------------------------------------
factorize

  23 25 2.3 -4 4     0 34 32/7 (31 %% 45) NULL    NA -3
1 23  5   2 -1 2 error  2    2         31 <NA> error -1
------------------------------------------
abs

  23    25 2.3 -4 4 0 34 32/7 (31 %% 45)  NULL   NA -3
1 23 error 2.3  4 4 0 34 32/7 (31 %% 45) error <NA>  3
> 
> ##==============================================================================
> 
> ###----------- matrix -----------------------------
> x  <- matrix(1:6,3)
> stopifnot(identical(as.bigz(x), matrix(as.bigz(as.vector(x)), 3)),
+           dim(x) == 3:2,
+           dim(x) == dim(ym   <- as.bigz(x, 6:1)),
+           dim(x) == dim(ymr  <- as.bigz(x, 4:6)),
+           dim(x) == dim(ymc  <- as.bigz(x, 4)),
+           dim(x) == dim(ymq  <- as.bigq(x)),
+           dim(x) == dim(y    <- as.bigq(x, 6:1))
+           ,
+           apply(ym,1,max) == 1:3,
+           apply(ym,2,min) == c(1,1,0))
> 
> x %*% t(x)
     [,1] [,2] [,3]
[1,]   17   22   27
[2,]   22   29   36
[3,]   27   36   45
> 
> ym %*% t(ym)
Big Integer ('bigz') 3 x 3 matrix:
     [,1] [,2] [,3]
[1,] 2    3    3   
[2,] 3    5    6   
[3,] 3    6    9   
> ym %*% t(ymr)
Big Integer ('bigz') 3 x 3 matrix:
     [,1] [,2] [,3]
[1,] 1    2    3   
[2,] 2    4    6   
[3,] 3    6    9   
> ymc %*% t(ymc)
Big Integer ('bigz') 3 x 3 matrix:
     [,1]     [,2]     [,3]    
[1,] (1 %% 4) (2 %% 4) (3 %% 4)
[2,] (2 %% 4) (1 %% 4) (0 %% 4)
[3,] (3 %% 4) (0 %% 4) (1 %% 4)
> ymq %*% t(ymq)
Big Rational ('bigq') 3 x 3 matrix:
     [,1] [,2] [,3]
[1,] 17   22   27  
[2,] 22   29   36  
[3,] 27   36   45  
> y %*% t(y)
Big Rational ('bigq') 3 x 3 matrix:
     [,1]  [,2]    [,3]  
[1,] 65/36 17/5    65/8  
[2,] 17/5  641/100 153/10
[3,] 65/8  153/10  585/16
> 
> dd <- dim(D  <- diag(1:4))
> stopifnot(dd == dim(Dmq  <- as.bigq(D)),
+           dd == dim(Dm   <- as.bigz(D,6:1)),
+           dd == dim(Dmr  <- as.bigz(D,7)),
+           dd == dim(Dmc  <- as.bigz(D,4)),
+           TRUE)
> solve(D)
     [,1] [,2]      [,3] [,4]
[1,]    1  0.0 0.0000000 0.00
[2,]    0  0.5 0.0000000 0.00
[3,]    0  0.0 0.3333333 0.00
[4,]    0  0.0 0.0000000 0.25
> solve(Dmq)
Big Rational ('bigq') 4 x 4 matrix:
     [,1] [,2] [,3] [,4]
[1,] 1    0    0    0   
[2,] 0    1/2  0    0   
[3,] 0    0    1/3  0   
[4,] 0    0    0    1/4 
> solve(Dmr)
Big Integer ('bigz') 4 x 4 matrix:
     [,1]     [,2]     [,3]     [,4]    
[1,] (1 %% 7) (0 %% 7) (0 %% 7) (0 %% 7)
[2,] (0 %% 7) (4 %% 7) (0 %% 7) (0 %% 7)
[3,] (0 %% 7) (0 %% 7) (5 %% 7) (0 %% 7)
[4,] (0 %% 7) (0 %% 7) (0 %% 7) (2 %% 7)
> try(solve(Dmc))# Error: argument has no inverse
Error in solve.bigz(Dmc) : argument has no inverse
> try(solve(Dm)) # Error: System is singular
Error in solve.bigz(Dm) : System is singular
> 
> (D.D <- try(D %*% t(Dm)))# now [>= Jan.2012] works too
Big Integer ('bigz') 4 x 4 matrix:
     [,1] [,2] [,3] [,4]
[1,] 1    0    0    0   
[2,] 0    0    0    0   
[3,] 0    0    3    0   
[4,] 0    0    0    4   
> 
> 
> proc.time()
   user  system elapsed 
  2.840   0.230   3.051 
